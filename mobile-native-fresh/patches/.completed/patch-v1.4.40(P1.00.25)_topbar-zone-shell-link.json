{
  "showInUI": true,
  "blockId": "patch-v1.4.40(P1.00.25)_topbar-zone-shell-link",
  "description": "Injects TopBarShellSlot and useTopBarZone into the layout shell system",
  "target": "BRAUN",
  "version": "patch-v1.4.40(P1.00.25)_topbar-zone-shell-link",

  "notes": [
    "GOAL: Enable slot-based TopBar rendering inside shell layout",
    "MISSION: Link layout skeleton to slot-aware rendering strategy",
    "CONTEXT: Phase 1 of src-nextgen rebuild, navigation + layout zone wiring",
    "SAFETY ENFORCEMENT: Full validator sweep enabled with runtime disown execution.",
    "STABLE STATE CHECK: Shell layout must render cleanly with TopBarShellSlot mount present.",
    "VALIDATION REQUIREMENTS:",
    "[x] TypeScript compilation (tsc --noEmit)",
    "[x] ESLint validation (eslint . --ext .ts,.tsx --max-warnings=0)",
    "[x] Unit test execution (yarn test:unit --watchAll=false)",
    "[x] Runtime functionality testing",
    "[x] Component behavior validation",
    "[x] Role assignment validation",
    "[x] Performance validation",
    "EXECUTION DIRECTIVES:",
    "- Run all shell commands non-blocking via `disown`",
    "- Use timeout wrapping for every validator",
    "- Auto-write summary to `.cursor-cache/MAIN/summaries/`",
    "DOCUMENTATION LAW: All patches must have matching `.md` summary file post-validation"
  ],

  "preCommit": {
    "backup": {
      "path": "/Users/sawyer/gitSync/tm-mobile-cursor/_backups/",
      "file": "20250723_UTC_v1.4.40_P1.00.25_topbar-zone-shell-link_backup_tm-mobile-cursor.tar.gz"
    },
    "shell": [
      "export NODE_ENV=development",
      "echo '[P1.00.25] Beginning TopBarShellSlot patch...'"
    ]
  },

  "mutations": [
    {
      "path": "/Users/sawyer/gitSync/tm-mobile-cursor/mobile-native-fresh/src-nextgen/core/layout/shell/TopBarShellSlot.tsx",
      "contents": "import React from 'react';\n\nexport const TopBarShellSlot = () => {\n  return <></>; // placeholder slot for top bar injection\n};"
    },
    {
      "path": "/Users/sawyer/gitSync/tm-mobile-cursor/mobile-native-fresh/src-nextgen/core/layout/shell/useTopBarZone.ts",
      "contents": "import { useContext } from 'react';\nimport { ShellSlotContext } from '../ShellSlotContext';\n\nexport const useTopBarZone = () => {\n  const ctx = useContext(ShellSlotContext);\n  return ctx?.topbarSlot;\n};"
    }
  ],

  "postMutationBuild": {
    "shell": [
      "(timeout 30s tsc --noEmit || exit 101) >/dev/null 2>&1 & disown",
      "(timeout 30s eslint . --ext .ts,.tsx --max-warnings=0 || exit 102) >/dev/null 2>&1 & disown",
      "(timeout 60s yarn test:unit --watchAll=false || exit 103) >/dev/null 2>&1 & disown",
      "(timeout 30s bash scripts/validate-runtime.sh || exit 104) >/dev/null 2>&1 & disown",
      "(timeout 30s bash scripts/validate-boot.sh || exit 105) >/dev/null 2>&1 & disown",
      "(timeout 30s bash scripts/validate-components.sh || exit 106) >/dev/null 2>&1 & disown",
      "(timeout 30s bash scripts/validate-visual.sh || exit 107) >/dev/null 2>&1 & disown",
      "(timeout 30s bash scripts/validate-performance.sh || exit 108) >/dev/null 2>&1 & disown"
    ]
  },

  "validate": {
    "shell": [
      "test -f /Users/sawyer/gitSync/.cursor-cache/MAIN/summaries/summary-v1.4.40(P1.00.25)_topbar-zone-shell-link.md || exit 109",
      "grep -q 'PASS' /Users/sawyer/gitSync/.cursor-cache/MAIN/summaries/summary-v1.4.40(P1.00.25)_topbar-zone-shell-link.md || exit 110"
    ]
  },

  "final": {
    "git": {
      "commit": "[PATCH P1.00.25] topbar-zone-shell-link — shell slot wiring + zone hook",
      "tag": "patch-v1.4.40(P1.00.25)_topbar-zone-shell-link"
    },
    "summary": "✅ patch-v1.4.40(P1.00.25)_topbar-zone-shell-link: TopBarShellSlot injected and validated.",
    "summaryFile": "/Users/sawyer/gitSync/.cursor-cache/MAIN/summaries/summary-v1.4.40(P1.00.25)_topbar-zone-shell-link.md"
  },

  "blockCommitOnError": true,
  "watchConsole": true,

  "execution": {
    "autoReleaseTimeoutMs": 30000,
    "onReloadHang": "Move to background and resume automatically"
  }
}
